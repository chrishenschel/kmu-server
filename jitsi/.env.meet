################################################################################
# Jitsi Meet Docker configuration for KMU stack
#
# This env file is used by jitsi/docker-compose.jitsi.yaml and is patched
# by 02-system-setup.sh to inject the real domain and strong secrets.
################################################################################

# Directory where all configuration will be stored (host path)
CONFIG=./jitsi/config

# Exposed HTTP/HTTPS ports for the Jitsi web container are NOT mapped to the
# host; Caddy terminates TLS and proxies to the web service over the
# caddy-proxy Docker network. These values are kept for completeness but are
# unused in this stack.
HTTP_PORT=8000
HTTPS_PORT=8443

# System time zone
TZ=Europe/Berlin

# Public URL for the web service (patched by 02-system-setup.sh)
PUBLIC_URL=https://meet.__DOMAIN__

# XMPP server hostname: use Docker service name so jicofo/jvb/prosody resolve it
XMPP_SERVER=prosody

# Caddy terminates TLS; Jitsi's internal nginx must stay on plain HTTP
DISABLE_HTTPS=1

# Use XMPP WebSocket for signaling (more reliable through reverse proxies)
ENABLE_XMPP_WEBSOCKET=1

# JVB must advertise the server's public IP so browsers can reach it for media.
# Patched by 02-system-setup.sh; set manually if needed.
JVB_ADVERTISE_IPS=__JVB_ADVERTISE_IPS__

################################################################################
# Authentication configuration
#
# JWT auth: only users with a valid JWT can create/start meetings. The KMU stack
# issues JWTs via the meet-sso service when users are authenticated through
# Authentik (Caddy forward_auth). Guests can still join once a meeting exists.
################################################################################

# Enable authentication (JWT required to start meetings)
ENABLE_AUTH=1

# Enable guest access (unauthenticated users wait in lobby until moderator joins)
ENABLE_GUESTS=1

# Authentication type: JWT tokens issued by meet-sso from Authentik session
AUTH_TYPE=jwt

# JWT application id and secret (must match meet-sso; patched by 02-system-setup.sh)
JWT_APP_ID=__JWT_APP_ID__
JWT_APP_SECRET=__JWT_APP_SECRET__

################################################################################
# Security â€“ XMPP component passwords
#
# These MUST be strong random values. 02-system-setup.sh will replace the
# placeholders on first run so that the secrets are never committed to git.
################################################################################

# XMPP password for Jicofo client connections (patched by 02-system-setup.sh)
JICOFO_AUTH_PASSWORD=__JICOFO_AUTH_PASSWORD__

# XMPP password for JVB client connections (patched by 02-system-setup.sh)
JVB_AUTH_PASSWORD=__JVB_AUTH_PASSWORD__

# Optional: additional passwords (Jigasi / Jibri) are not needed because we
# do not run those components in this stack.

################################################################################
# TURN / STUN configuration
#
# A dedicated coturn instance is used for NAT traversal. These values are
# patched by 02-system-setup.sh to match your domain and generated credentials.
################################################################################

TURN_HOST=turn.__DOMAIN__
TURNS_HOST=turn.__DOMAIN__
TURN_PORT=3478
TURNS_PORT=5349
TURN_TRANSPORT=udp

TURN_USERNAME=__TURN_USER__
TURN_PASSWORD=__TURN_PASS__


