[server.listener.smtp]
bind = "[::]:25"
protocol = "smtp"

[server.listener.http]
bind = ["0.0.0.0:8080"]
protocol = "http"
url = "https://mail.__DOMAIN__"
use-proxy-headers = true

[storage]
data = "postgres"
directory = "postgres"
blob = "fs"
fts = "rocksdb"
lookup = "rocksdb"

[store.postgres]
type = "sql"
host = "postgres"
port = 5432
database = "stalwart"
user = "postgres"
password = "__PG_PASS__"

[store.fs]
type = "fs"
path = "/opt/stalwart/blobs"

[store.rocksdb]
type = "rocksdb"
path = "/opt/stalwart/data"
compression = "lz4"

[directory.internal]
type = "internal"
store = "rocksdb"

[tracer.log]
type = "log"
level = "info"
path = "/opt/stalwart/logs"
prefix = "stalwart.log"
rotate = "daily"
ansi = false
enable = true

[session]
auth-mechanisms = ["plain", "oidc"]

[directory.authentik]
type = "oidc"
timeout = "15s"
client-id = "__CLIENT_ID__"
client-secret = "__CLIENT_SECRET__"
issuer-url = "https://auth.__DOMAIN__/application/o/stalwart-mail/"
create-not-found = true

[directory.authentik.fields]
username = "preferred_username"
email = "email"
full-name = "name"
